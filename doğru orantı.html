<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hesaplama Araçları</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h2>Doğru Orantı Hesaplama</h2>
        <!-- Orantı hesaplama için eski kodlar aynen kalıyor -->
        <div class="row">
            <input type="text" id="a" placeholder="A" onblur="formatNumber(this)" onkeypress="handleEnter(event, 'ratioForm')"> / 
            <input type="text" id="b" placeholder="B" onblur="formatNumber(this)" onkeypress="handleEnter(event, 'ratioForm')">
        </div>
        <div class="row">
            <input type="text" id="c" placeholder="C" onblur="formatNumber(this)" onkeypress="handleEnter(event, 'ratioForm')"> / 
            <input type="text" id="d" placeholder="D" onblur="formatNumber(this)" onkeypress="handleEnter(event, 'ratioForm')">
        </div>
        <button onclick="calculateRatio()">Hesapla</button>
        <div class="result" id="ratioResult"></div>

        <hr>
        <br>
        <hr>

        <h2>Çevrim Katsayısı</h2>
        <!-- Yeni çap hesaplama formu -->
        <div class="row">
            <input type="text" id="inputCap" placeholder="Giriş Çapı" oninput="calculateCap()" onkeypress="handleEnter(event, 'capForm')">
        </div>
        <div class="row">
            <input type="text" id="outputCap" placeholder="Çıkış Çapı" oninput="calculateCap()" onkeypress="handleEnter(event, 'capForm')">
        </div>
        <button onclick="calculateCap()">Hesapla</button>
        <div class="result" id="capResult"></div>
    </div>

    <script>
        // Yardımcı: kullanıcı girdisini normalize edip sayıya çevirir
        function parseInputNumberFromId(id) {
            const el = document.getElementById(id);
            if (!el) return NaN;
            const str = el.value.trim().replace(/\./g, "").replace(/,/g, ".");
            const num = parseFloat(str);
            return isNaN(num) ? NaN : num;
        }

        // Yardımcı: sayıyı yerel formatta inputa yazar
        function formatOutputNumberToInput(id, num, digits = 2) {
            const el = document.getElementById(id);
            if (!el) return;
            if (isNaN(num)) el.value = '';
            else el.value = num.toLocaleString('tr-TR', { minimumFractionDigits: digits, maximumFractionDigits: digits });
        }

        // input blur olduğunda çalışacak basit formatlayıcı (caret koruması basitçe blur ile sağlanır)
        function formatNumber(input) {
            const value = input.value.trim().replace(/\./g, '').replace(/,/g, '.');
            if (value === '') { input.value = ''; return; }
            const n = parseFloat(value);
            if (isNaN(n)) { input.value = ''; return; }
            input.value = n.toLocaleString('tr-TR');
        }

        // Enter tuşuyla ilgili formu çalıştır
        function handleEnter(event, formName) {
            if (event.key === "Enter") {
                if (formName === 'ratioForm') {
                    calculateRatio();
                } else if (formName === 'capForm') {
                    calculateCap();
                }
            }
        }

        // Doğru Orantı Hesabı
        function calculateRatio() {
            const a = parseInputNumberFromId('a');
            const b = parseInputNumberFromId('b');
            const c = parseInputNumberFromId('c');
            const d = parseInputNumberFromId('d');

            let resultText = "";

            if (!isNaN(a) && !isNaN(b) && !isNaN(c)) {
                const dValue = (b * c) / a;
                formatOutputNumberToInput('d', dValue, 2);
                resultText = `D = ${dValue.toFixed(2)}`;
            }

            if (!isNaN(a) && !isNaN(b) && !isNaN(d)) {
                const cValue = (a * d) / b;
                formatOutputNumberToInput('c', cValue, 2);
                resultText = `C = ${cValue.toFixed(2)}`;
            }

            if (!isNaN(c) && !isNaN(d) && !isNaN(a)) {
                const bValue = (a * d) / c;
                formatOutputNumberToInput('b', bValue, 2);
                resultText = `B = ${bValue.toFixed(2)}`;
            }

            if (!isNaN(c) && !isNaN(d) && !isNaN(b)) {
                const aValue = (b * c) / d;
                formatOutputNumberToInput('a', aValue, 2);
                resultText = `A = ${aValue.toFixed(2)}`;
            }

            document.getElementById('ratioResult').innerText = resultText || "Lütfen eksik değeri hesaplamak için gerekli değerleri girin.";
        }

        // Çap Hesaplama - Artık ondalıklı sayıları kabul eder
        function calculateCap() {
            const inputCap = parseInputNumberFromId('inputCap');
            const outputCap = parseInputNumberFromId('outputCap');

            if (isNaN(inputCap) || isNaN(outputCap)) {
                document.getElementById('capResult').innerText = "Lütfen geçerli giriş ve çıkış çapı değerleri girin (örn. 7,5 ya da 6.2).";
                return;
            }

            if (inputCap === 0) {
                document.getElementById('capResult').innerText = "Giriş çapı sıfır olamaz.";
                return;
            }

            const step1 = 100000 / inputCap / inputCap;
            const result = step1 * outputCap * outputCap;
            const roundedResult = Math.round(result);

            document.getElementById('capResult').innerText = `Sonuç: ${roundedResult.toLocaleString("tr-TR")}`;
        }
    </script>
</body>
</html>